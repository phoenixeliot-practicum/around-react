(()=>{"use strict";class e{constructor(e,t,s){this.data=e,this.templateSelector=t,this.handleCardClick=s}render(){const e=document.querySelector(this.templateSelector).content.querySelector(".places__item").cloneNode(!0),t=e.querySelector(".card__like-button"),s=e.querySelector(".card__delete-button"),n=e.querySelector(".card__image");return n.src=this.data.link,e.querySelector(".card__title").textContent=this.data.name,t.addEventListener("click",this._handleLikeIcon),s.addEventListener("click",this._handleDeleteCard),n.addEventListener("click",(()=>this.handleCardClick(this.data))),this.element=e,e}_handleLikeIcon(e){e.target.classList.toggle("card__like-button_is-active")}_handleDeleteCard(e){e.target.closest(".card").remove()}}class t{constructor(e,t){this.settings=e,this.formElement=t}enableValidation(){this.formElement.addEventListener("submit",(e=>{e.preventDefault()})),this.setEventListeners()}setEventListeners(){const e=Array.from(this.formElement.querySelectorAll(this.settings.inputSelector)),t=this.formElement.querySelector(this.settings.submitButtonSelector);e.forEach((s=>{s.addEventListener("input",(()=>{this.checkInputValidity(s),this.toggleButtonState(e,t)}))}))}showInputError(e,t){const s=this.formElement.querySelector(`#${e.id}-error`);e.classList.add(this.settings.inputErrorClass),s.textContent=t,s.classList.add(this.settings.errorClass)}hideInputError(e){const t=this.formElement.querySelector(`#${e.id}-error`);e.classList.remove(this.settings.inputErrorClass),t.classList.remove(this.settings.errorClass),t.textContent=""}checkInputValidity(e){e.validity.valid?this.hideInputError(e):this.showInputError(e,e.validationMessage)}hasInvalidInput(e){return e.some((e=>!e.validity.valid))}toggleButtonState(e,t){this.hasInvalidInput(e)?(t.classList.add(this.settings.inactiveButtonClass),t.disabled=!0):(t.classList.remove(this.settings.inactiveButtonClass),t.disabled=!1)}}class s{constructor(e){this.element=document.querySelector(e)}open(){this.element.classList.add("popup_is-opened")}close(){this.element.classList.remove("popup_is-opened")}_handleEscClose(e){27===e.which&&this.close()}setEventListeners(){document.addEventListener("keyup",this._handleEscClose.bind(this)),this.element.addEventListener("click",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close"))&&this.close()}))}}class n extends s{constructor(e,t){super(e),this.inputs={},this.element.querySelectorAll("form input").forEach((e=>{this.inputs[e.getAttribute("name")]=e})),this.handleSubmit=t}_getInputValues(){const e={};return Object.keys(this.inputs).forEach((t=>{e[t]=this.inputs[t].value})),e}setEventListeners(){super.setEventListeners(),this.element.addEventListener("submit",(e=>{e.preventDefault(),this.handleSubmit(this._getInputValues()),this.close()}))}open(e={}){Object.keys(this.inputs).forEach((t=>{this.inputs[t].value=e[t]||""})),super.open()}close(){super.close(),Object.keys(this.inputs).forEach((e=>{this.inputs[e].value=""}))}}const r=document.querySelector(".profile__edit-button"),i=document.querySelector(".profile__add-button"),o=new class extends s{constructor(e){super(e),this.imageElement=this.element.querySelector(".popup__image"),this.imageCaption=this.element.querySelector(".popup__caption")}open({name:e,link:t}){this.imageElement.src=t,this.imageElement.alt=`Изображение ${e}`,this.imageCaption.textContent=e,super.open()}}(".popup_type_image");o.setEventListeners();const a=new class{constructor({items:e,renderer:t},s){this.items=e,this.renderer=t,this.sectionSelector=s,this.element=document.querySelector(s)}render(){this.items.forEach((e=>{this.element.append(this.renderer(e))}))}addItem(e){this.element.prepend(this.renderer(e))}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:t=>new e(t,"#card-template",(e=>{o.open(e)})).render()},".places__list");a.render();const l=new n(".popup_type_edit",(e=>{p.setUserInfo(e)}));l.setEventListeners();const c=new n(".popup_type_new-card",(e=>{a.addItem(e)}));c.setEventListeners();const p=new class{constructor(e){this.selectors=e,this.elements={name:document.querySelector(e.nameSelector),description:document.querySelector(e.descriptionSelector)}}getUserInfo(){return Object.fromEntries(Object.entries(this.elements).map((([e,t])=>[e,t.textContent])))}setUserInfo(e){Object.keys(e).forEach((t=>{this.elements[t].textContent=e[t]}))}}({nameSelector:".profile__title",descriptionSelector:".profile__description"});p.setUserInfo({name:"Johan Smithy",description:"Explorer Extraordinaire"}),r.addEventListener("click",(()=>{const e=p.getUserInfo();l.open(e)})),i.addEventListener("click",(()=>{c.open()}));const d={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};Array.from(document.querySelectorAll(".popup__form")).forEach((e=>{new t(d,e).enableValidation()}))})();